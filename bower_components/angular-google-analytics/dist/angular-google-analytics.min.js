/**
 * Angular Google Analytics - Easy tracking for your AngularJS application
 * @version v0.0.18 - 2015-07-29
 * @link http://github.com/revolunet/angular-google-analytics
 * @author Julien Bouquillon <julien@revolunet.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
(function(n,t,e){"use strict";e.module("angular-google-analytics",[]).provider("Analytics",function(){var i,a,c,r,o,s,u=!1,g=!0,d="",l=!1,m="$routeChangeSuccess",_="auto",f=!1,h=!1,p=!1,k=!1,v=!1,E={allowLinker:!0},y=!1,w=!1;this._logs=[],this.setAccount=function(n){return i=n,!0},this.trackPages=function(n){return g=n,!0},this.trackPrefix=function(n){return d=n,!0},this.setDomainName=function(n){return c=n,!0},this.useDisplayFeatures=function(n){return a=!!n,!0},this.useAnalytics=function(n){return l=!!n,!0},this.useEnhancedLinkAttribution=function(n){return p=!!n,!0},this.useCrossDomainLinker=function(n){return v=!!n,!0},this.setCrossLinkDomains=function(n){return s=n,!0},this.setPageEvent=function(n){return m=n,!0},this.setCookieConfig=function(n){return _=n,!0},this.useECommerce=function(n,t){return f=!!n,h=!!t,!0},this.setRemoveRegExp=function(n){return n instanceof RegExp?(r=n,!0):!1},this.setExperimentId=function(n){return o=n,!0},this.ignoreFirstPageLoad=function(n){return k=!!n,!0},this.trackUrlParams=function(n){return y=!!n,!0},this.delayScriptTag=function(n){return w=!!n,!0},this.$get=["$document","$location","$log","$rootScope","$window",function(T,A,P,b,q){function C(n){!l&&q._gaq&&"function"==typeof n&&n()}function I(n){l&&q.ga&&"function"==typeof n&&n()}function j(n,t){return!e.isUndefined(t)&&"name"in t&&t.name?t.name+"."+n:n}function L(n,t){return n in t&&t[n]}var S=this,x=function(){var n=y?A.url():A.path();return r?n.replace(r,""):n},D=function(){var n={utm_source:"campaignSource",utm_medium:"campaignMedium",utm_term:"campaignTerm",utm_content:"campaignContent",utm_campaign:"campaignName"},t={};return e.forEach(A.search(),function(i,a){var c=n[a];e.isDefined(c)&&(t[c]=i)}),t};return this._log=function(){arguments.length>0&&(arguments.length>1&&"warn"===arguments[0]&&P.warn(Array.prototype.slice.call(arguments,1)),this._logs.push(arguments))},this._createScriptTag=function(){if(!i)return S._log("warn","No account id set to create script tag"),undefined;if(u)return S._log("warn","Script tag already created"),undefined;q._gaq=[],q._gaq.push(["_setAccount",i]),c&&q._gaq.push(["_setDomainName",c]),p&&q._gaq.push(["_require","inpage_linkid","//www.google-analytics.com/plugins/ga/inpage_linkid.js"]),g&&!k&&(r?q._gaq.push(["_trackPageview",x()]):q._gaq.push(["_trackPageview"]));var n;return n=a?("https:"===t.location.protocol?"https://":"http://")+"stats.g.doubleclick.net/dc.js":("https:"===t.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js",function(){var t=T[0],e=t.createElement("script");e.type="text/javascript",e.async=!0,e.src=n;var i=t.getElementsByTagName("script")[0];i.parentNode.insertBefore(e,i)}(n),u=!0,!0},this._createAnalyticsScriptTag=function(){if(!i)return S._log("warn","No account id set to create analytics script tag"),undefined;if(u)return S._log("warn","Analytics script tag already created"),undefined;if(function(n,t,e,i,a,c,r){n.GoogleAnalyticsObject=a,n[a]=n[a]||function(){(n[a].q=n[a].q||[]).push(arguments)},n[a].l=1*new Date,c=t.createElement(e),r=t.getElementsByTagName(e)[0],c.async=1,c.src=i,r.parentNode.insertBefore(c,r)}(n,t,"script","//www.google-analytics.com/analytics.js","ga"),e.isArray(i)?i.forEach(function(n){var t,i="cookieConfig"in n?n.cookieConfig:_;L("crossDomainLinker",n)&&(n.allowLinker=n.crossDomainLinker),e.forEach(["name","allowLinker"],function(i){i in n&&(e.isUndefined(t)&&(t={}),t[i]=n[i])}),e.isUndefined(t)?q.ga("create",n.tracker,i):q.ga("create",n.tracker,i,t),t&&"allowLinker"in t&&t.allowLinker&&(q.ga(j("require",n),"linker"),L("crossLinkDomains",n)&&q.ga(j("linker:autoLink",n),n.crossLinkDomains))}):v?(q.ga("create",i,_,E),q.ga("require","linker"),s&&q.ga("linker:autoLink",s)):q.ga("create",i,_),a&&q.ga("require","displayfeatures"),g&&!k&&q.ga("send","pageview",x()),q.ga&&(f&&(h?q.ga("require","ec","ec.js"):q.ga("require","ecommerce","ecommerce.js")),p&&q.ga("require","linkid","linkid.js"),o)){var c=t.createElement("script"),r=t.getElementsByTagName("script")[0];c.src="//www.google-analytics.com/cx/api.js?experiment="+o,r.parentNode.insertBefore(c,r)}return u=!0,!0},this._ecommerceEnabled=function(){return f&&!h},this._enhancedEcommerceEnabled=function(){return f&&h},this._trackPage=function(n,t,a){var c=this,r=arguments;n=n?n:x(),t=t?t:T[0].title,C(function(){q._gaq.push(["_set","title",t]),q._gaq.push(["_trackPageview",d+n]),c._log("_trackPageview",n,t,r)}),I(function(){var o={page:d+n,title:t};e.extend(o,D()),e.isObject(a)&&e.extend(o,a),e.isArray(i)?i.forEach(function(n){q.ga(j("send",n),"pageview",o)}):q.ga("send","pageview",o),c._log("pageview",n,t,r)})},this._trackEvent=function(n,t,a,c,r,o){var s=this,u=arguments;C(function(){q._gaq.push(["_trackEvent",n,t,a,c,!!r]),s._log("trackEvent",u)}),I(function(){var g={};e.isDefined(r)&&(g.nonInteraction=!!r),e.isObject(o)&&e.extend(g,o),e.isArray(i)?i.forEach(function(e){L("trackEvent",e)&&q.ga(j("send",e),"event",n,t,a,c,g)}):q.ga("send","event",n,t,a,c,g),s._log("event",u)})},this._addTrans=function(n,t,e,i,a,c,r,o,s){var u=this,g=arguments;C(function(){q._gaq.push(["_addTrans",n,t,e,i,a,c,r,o]),u._log("_addTrans",g)}),I(function(){u._ecommerceEnabled()&&(q.ga("ecommerce:addTransaction",{id:n,affiliation:t,revenue:e,tax:i,shipping:a,currency:s||"USD"}),u._log("ecommerce:addTransaction",g))})},this._addItem=function(n,t,e,i,a,c){var r=this,o=arguments;C(function(){q._gaq.push(["_addItem",n,t,e,i,a,c]),r._log("_addItem",o)}),I(function(){r._ecommerceEnabled()&&(q.ga("ecommerce:addItem",{id:n,name:e,sku:t,category:i,price:a,quantity:c}),r._log("ecommerce:addItem",o))})},this._trackTrans=function(){var n=this,t=arguments;C(function(){q._gaq.push(["_trackTrans"]),n._log("_trackTrans",t)}),I(function(){n._ecommerceEnabled()&&(q.ga("ecommerce:send"),n._log("ecommerce:send",t))})},this._clearTrans=function(){var n=this,t=arguments;I(function(){n._ecommerceEnabled()&&(q.ga("ecommerce:clear"),n._log("ecommerce:clear",t))})},this._addProduct=function(n,t,e,i,a,c,r,o,s){var u=this,g=arguments;C(function(){q._gaq.push(["_addProduct",n,t,e,i,a,c,r,o,s]),u._log("_addProduct",g)}),I(function(){u._enhancedEcommerceEnabled()&&(q.ga("ec:addProduct",{id:n,name:t,category:e,brand:i,variant:a,price:c,quantity:r,coupon:o,position:s}),u._log("ec:addProduct",g))})},this._addImpression=function(n,t,e,i,a,c,r,o){var s=this,u=arguments;C(function(){q._gaq.push(["_addImpression",n,t,e,i,a,c,r,o]),s._log("_addImpression",u)}),I(function(){s._enhancedEcommerceEnabled()&&(q.ga("ec:addImpression",{id:n,name:t,category:a,brand:i,variant:c,list:e,position:r,price:o}),s._log("ec:addImpression",u))})},this._addPromo=function(n,t,e,i){var a=this,c=arguments;C(function(){q._gaq.push(["_addPromo",n,t,e,i]),a._log("_addPromo",arguments)}),I(function(){a._enhancedEcommerceEnabled()&&(q.ga("ec:addPromo",{id:n,name:t,creative:e,position:i}),a._log("ec:addPromo",c))})},this._getActionFieldObject=function(n,t,e,i,a,c,r,o,s){var u={};return n&&(u.id=n),t&&(u.affiliation=t),e&&(u.revenue=e),i&&(u.tax=i),a&&(u.shipping=a),c&&(u.coupon=c),r&&(u.list=r),o&&(u.step=o),s&&(u.option=s),u},this._setAction=function(n,t){var e=this,i=arguments;C(function(){q._gaq.push(["_setAction",n,t]),e._log("__setAction",i)}),I(function(){e._enhancedEcommerceEnabled()&&(q.ga("ec:setAction",n,t),e._log("ec:setAction",i))})},this._trackTransaction=function(n,t,e,i,a,c,r,o,s){this._setAction("purchase",this._getActionFieldObject(n,t,e,i,a,c,r,o,s))},this._trackRefund=function(n){this._setAction("refund",this._getActionFieldObject(n))},this._trackCheckOut=function(n,t){this._setAction("checkout",this._getActionFieldObject(null,null,null,null,null,null,null,n,t))},this._trackCart=function(n){-1!==["add","remove"].indexOf(n)&&(this._setAction(n),this._send("event","UX","click",n+" to cart"))},this._promoClick=function(n){this._setAction("promo_click"),this._send("event","Internal Promotions","click",n)},this._productClick=function(n){this._setAction("click",this._getActionFieldObject(null,null,null,null,null,null,n,null,null)),this._send("event","UX","click",n)},this._send=function(){var n=this,t=Array.prototype.slice.call(arguments);t.unshift("send"),I(function(){q.ga.apply(this,t),n._log(t)})},this._pageView=function(){this._send("pageview")},this._set=function(n,t){var e=this;I(function(){q.ga("set",n,t),e._log("set",n,t)})},w||(l?this._createAnalyticsScriptTag():this._createScriptTag()),g&&b.$on(m,function(){S._trackPage()}),this._trackTimings=function(n,t,e,i){this._send("timing",n,t,e,i)},{_logs:S._logs,displayFeatures:a,ecommerce:f,enhancedEcommerce:h,enhancedLinkAttribution:p,getUrl:x,experimentId:o,ignoreFirstPageLoad:k,delayScriptTag:w,setCookieConfig:S._setCookieConfig,getCookieConfig:function(){return _},createAnalyticsScriptTag:function(n){return n&&(_=n),S._createAnalyticsScriptTag()},createScriptTag:function(n){return n&&(_=n),S._createScriptTag()},ecommerceEnabled:function(){return S._ecommerceEnabled()},enhancedEcommerceEnabled:function(){return S._enhancedEcommerceEnabled()},trackPage:function(n,t,e){S._trackPage(n,t,e)},trackEvent:function(n,t,e,i,a,c){S._trackEvent(n,t,e,i,a,c)},addTrans:function(n,t,e,i,a,c,r,o,s){S._addTrans(n,t,e,i,a,c,r,o,s)},addItem:function(n,t,e,i,a,c){S._addItem(n,t,e,i,a,c)},trackTrans:function(){S._trackTrans()},clearTrans:function(){S._clearTrans()},addProduct:function(n,t,e,i,a,c,r,o,s){S._addProduct(n,t,e,i,a,c,r,o,s)},addPromo:function(n,t,e,i){S._addPromo(n,t,e,i)},addImpression:function(n,t,e,i,a,c,r,o){S._addImpression(n,t,e,i,a,c,r,o)},productClick:function(n){S._productClick(n)},promoClick:function(n){S._promoClick(n)},trackDetail:function(){S._setAction("detail"),S._pageView()},trackCart:function(n){S._trackCart(n)},trackCheckout:function(n,t){S._trackCheckOut(n,t)},trackTimings:function(n,t,e,i){S._trackTimings(n,t,e,i)},trackTransaction:function(n,t,e,i,a,c,r,o,s){S._trackTransaction(n,t,e,i,a,c,r,o,s)},setAction:function(n,t){S._setAction(n,t)},send:function(n){S._send(n)},pageView:function(){S._pageView()},set:function(n,t){S._set(n,t)}}}]}).directive("gaTrackEvent",["Analytics","$parse",function(n,t){return{restrict:"A",link:function(e,i,a){var c=t(a.gaTrackEvent);i.bind("click",function(){(!a.gaTrackEventIf||e.$eval(a.gaTrackEventIf))&&c.length>1&&n.trackEvent.apply(n,c(e))})}}}])})(window,document,window.angular);